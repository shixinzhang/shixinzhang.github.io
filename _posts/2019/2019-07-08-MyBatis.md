---
layout: post
title: MyBatis 入门
categories: JavaWeb
description: SpringMVC 入门, MyBatis
keywords: JavaWeb MyBatis
---

[MyBatis中文官网](http://www.mybatis.cn/archives/605.html)


![](http://images2015.cnblogs.com/blog/897287/201602/897287-20160227222125065-2096129627.png)

# Why MyBatis

## 传统 JDBC 缺点

传统 JDBC :

```
public class DBHelper {
    public static final String URL = "jdbc:mysql://localhost:3306/helloworld";

    public static final String NAME = "com.mysql.jdbc.Driver";

    public static final String USER = "root";
    public static final String PASSWORD = "root";

    private Connection connection;
    public PreparedStatement preparedStatement;

    public DBHelper(String sql) {
        try {
            Class.forName(NAME);
            connection = DriverManager.getConnection(URL, USER, PASSWORD);
            preparedStatement = connection.prepareStatement(sql);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public void close() {
        try {
            this.connection.close();
            this.preparedStatement.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}

public class DeveloperDao {
    public List<DeveloperModel> getAllDevelopers() {
        List<DeveloperModel> developerList = new ArrayList<>();
        String sql = "select * from developer";
        DBHelper dbHelper = new DBHelper(sql);
        ResultSet resultSet = null;
        try {
            resultSet = dbHelper.preparedStatement.executeQuery();
            while (resultSet.next()) {
                developerList.add(buildDeveloperModel(resultSet));
            }
            resultSet.close();
            dbHelper.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return developerList;
    }
}

```

**``Connection`` → ``Statement`` → ``ResultSet`` → 获取字段的值 → close**

缺点，硬编码太多：

1. 数据库驱动类名
2. db 连接地址
3. db 账号、密码
4. SQL 语句
5. 查询结果硬编码为表字段

还有数据库的频繁连接和断开。

任何一个有变动都需要修改 Java 代码、编译、重新发布。

## MyBatis 的优点

``MyBatis`` 采用配置文件动态管理 SQL 语句，并含有输入映射、输出映射机制，和数据库连接池配置的持久层框架，让开发人员将精力集中于 SQL 语句上。


优点：

1. 可以将 SQL 语句配置在 XML 文件里
2. 在 SQL 语句配置文件中提供输入参数的映射，实现参数动态配置
3. 输出映射机制，可以将结果集的检索自动隐射成对应的 Java 对象
4. 还可以创建自己的数据库连接池，在 XML 里进行配置管理

# MyBatis 的整体架构


``MyBatis`` 主要组成：

1. 数据源配置文件
2. SQL 映射配置文件
3. 会话工厂 ``SqlSessionFactory``
4. 会话 ``SqlSession``
5. 执行器
6. 底层封装对象

``MyBatis`` 的核心就是基于 SQL 配置的 Mapper 映射文件，所有数据库操作都会基于该映射文件和配置的 SQL 语句。

会话工厂 ``SqlSessionFactory`` 可以根据数据库配置信息，产生可以连接数据库并交互的 会话 ``SqlSession`` 实例。


# MyBatis 运行流程 

![](https://gss0.bdstatic.com/-4o3dSag_xI4khGkpoWK1HF6hhy/baike/c0%3Dbaike80%2C5%2C5%2C80%2C26/sign=4df3ab1439dbb6fd3156ed74684dc07d/0b46f21fbe096b63ea0d41bf0c338744eaf8accc.jpg)

# Thanks

- 《SpringMVC + MyBatis 开发从入门到项目实战》